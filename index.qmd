---
title: "Grade Mark Correlation Features for University Students"
author: "Bananchiki Group: Lev Laptinov, Dmytro Kolisnyk, Vasyl Moiseiev"
---

# Introduction

[Source of dataset](https://archive.ics.uci.edu/dataset/697/predict+students+dropout+and+academic+success)

A dataset created from a higher education institution (acquired from several disjoint databases) related to students enrolled in different undergraduate degrees, such as agronomy, design, education, nursing, journalism, management, social service, and technologies. The dataset includes information known at the time of student enrollment (academic path, demographics, and social-economic factors) and the students' academic performance at the end of the first and second semesters. [Dataset is already performed a rigorous data preprocessing to handle data from anomalies, unexplainable outliers, and missing values.](https://arc.net/l/quote/emkqvmzr)

```{r, include=FALSE}
library(tidyverse)
library(skimr)
library(tidymodels)
```

# Data Loading and Preprocessing

```{r, include=FALSE}
data <- read_delim("data.csv", delim = ";")
head(data)
```

```{r}
selected_data <- data %>%
  select(
    attendance_type = `Daytime/evening attendance\t`,
    previous_qualification_grade = `Previous qualification (grade)`,
    admission_grade = `Admission grade`,
    gender = `Gender`,
    scholarship_holder = `Scholarship holder`,
    age_at_enrollment = `Age at enrollment`,
    first_sem_grade = `Curricular units 1st sem (grade)`,
    second_sem_grade = `Curricular units 2nd sem (grade)`
  ) %>%
  filter(
    admission_grade > 0,
    previous_qualification_grade > 0,
    first_sem_grade > 0,
    second_sem_grade > 0
  ) %>%
  mutate(
    first_year_grade = (first_sem_grade + second_sem_grade) / 2,
    attendance_type = factor(if_else(attendance_type == 1, "daytime", "evening")),
    gender = factor(if_else(gender == 1, "male", "female")),
    scholarship_holder = factor(if_else(scholarship_holder == 1, "yes", "no"))
  )
```



# Research Question

**What are the significant factors influencing first-year academic performance among students, as measured by the average first-year grade?**

Understanding the factors that influence academic performance is crucial for improving educational outcomes. This can not only be useful for students to improve their grades but also guide universities in designing interventions, such as targeted support for specific groups.

# Exploratory Data Analysis

```{r}
skim(selected_data)
```

## Distribution of Grades

```{r}
sturges_bins <- function(data) {
  ceiling(1 + log2(length(data)))
}

# Admission Grade Distribution
admission_bins <- sturges_bins(selected_data$admission_grade)
ggplot(selected_data, aes(x = admission_grade)) +
  geom_histogram(bins = admission_bins, fill = "steelblue", color = "black") +
  theme_minimal() +
  labs(
    title = "Histogram of Admission Grade",
    x = "Admission Grade",
    y = "Count"
  )

# First-Semester Grade Distribution
first_sem_bins <- sturges_bins(selected_data$first_sem_grade)
ggplot(selected_data, aes(x = first_sem_grade)) +
  geom_histogram(bins = first_sem_bins, fill = "steelblue", color = "black") +
  theme_minimal() +
  labs(
    title = "Histogram of First-Semester Grade",
    x = "First-Semester Grade",
    y = "Count"
  )

# Second-Semester Grade Distribution
second_sem_bins <- sturges_bins(selected_data$second_sem_grade)
ggplot(selected_data, aes(x = second_sem_grade)) +
  geom_histogram(bins = second_sem_bins, fill = "steelblue", color = "black") +
  theme_minimal() +
  labs(
    title = "Histogram of Second-Semester Grade",
    x = "Second-Semester Grade",
    y = "Count"
  )

# Previous Qualification Grade Distribution
previous_qualification_bins <- sturges_bins(selected_data$previous_qualification_grade)
ggplot(selected_data, aes(x = previous_qualification_grade)) +
  geom_histogram(bins = previous_qualification_bins, fill = "steelblue", color = "black") +
  theme_minimal() +
  labs(
    title = "Histogram of Previous Qualification Grade",
    x = "Previous Qualification Grade",
    y = "Count"
  )
```

## Correlations

```{r}
cor_first_sem <- cor(selected_data$admission_grade, selected_data$first_sem_grade, use = "complete.obs")
cor_second_sem <- cor(selected_data$admission_grade, selected_data$second_sem_grade, use = "complete.obs")
cor_previous_qualification <- cor(selected_data$admission_grade, selected_data$previous_qualification_grade, use = "complete.obs")

list(
  cor_first_sem = cor_first_sem,
  cor_second_sem = cor_second_sem,
  cor_previous_qualification = cor_previous_qualification
)
```

# Linear and Nonlinear Relationships

## Admission Grade vs First-Year Grade

```{r}
# Linear and Nonlinear Models
selected_data <- selected_data %>%
  mutate(admission_grade_squared = admission_grade^2)

linear_fit <- lm(first_year_grade ~ admission_grade, data = selected_data)
nonlinear_fit <- lm(first_year_grade ~ admission_grade_squared, data = selected_data)

# Model Summaries
knitr::kable(tidy(linear_fit))
knitr::kable(tidy(nonlinear_fit))

# Visualization
r2_linear <- glance(linear_fit)$r.squared
r2_nonlinear <- glance(nonlinear_fit)$r.squared

list(
  r2_linear = r2_linear,
  r2_nonlinear = r2_nonlinear
)

ggplot(selected_data, aes(x = admission_grade, y = first_year_grade)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Nonlinear Relationship Between Admission Grade and First-Year Grade",
    x = "Admission Grade",
    y = "First-Year Grade"
  ) +
  theme_minimal()
```

## Admission Grade vs Previous Qualification Grade

```{r}
linear_fit <- lm(previous_qualification_grade ~ admission_grade, data = selected_data)
nonlinear_fit <- lm(previous_qualification_grade ~ admission_grade_squared, data = selected_data)

# Model Summaries
knitr::kable(tidy(linear_fit))
knitr::kable(tidy(nonlinear_fit))

# Visualization
r2_linear <- glance(linear_fit)$r.squared
r2_nonlinear <- glance(nonlinear_fit)$r.squared

list(
  r2_linear = r2_linear,
  r2_nonlinear = r2_nonlinear
)

ggplot(selected_data, aes(x = admission_grade, y = previous_qualification_grade)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Nonlinear Relationship Between Admission Grade and Previous Qualification Grade",
    x = "Admission Grade",
    y = "Previous Qualification Grade",
  ) +
  theme_minimal()
```


```{r}
ggplot(selected_data, aes(x = admission_grade, y = first_year_grade, color = gender, shape = factor(gender))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  geom_smooth(
    method = "lm", se = FALSE, color = "gray", linetype = "dashed",
    aes(group = 1)
  ) +
  labs(
    title = "First-Year Grade vs Admission Grade with gender Trends",
    x = "Admission Grade",
    y = "First-Year Grade",
    color = "Gender",
    shape = "Gender"
  ) +
  theme_minimal()
```
```{r}
ggplot(selected_data, aes(x = admission_grade, y = first_year_grade, color = scholarship_holder, shape = factor(scholarship_holder))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  geom_smooth(
    method = "lm", se = FALSE, color = "gray", linetype = "dashed",
    aes(group = 1)
  ) +
  labs(
    title = "First-Year Grade vs Admission Grade with Scholarship Holder Trends",
    x = "Admission Grade",
    y = "First-Year Grade",
    color = "Scholarship Holder",
    shape = "Scholarship Holder"
  ) +
  theme_minimal()
```
```{r}
ggplot(selected_data, aes(x = admission_grade, y = first_year_grade, color = attendance_type, shape = factor(attendance_type))) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  geom_smooth(
    method = "lm", se = FALSE, color = "gray", linetype = "dashed",
    aes(group = 1)
  ) +
  labs(
    title = "First-Year Grade vs Admission Grade with Attendance Type Trends",
    x = "Admission Grade",
    y = "First-Year Grade",
    color = "Attendance Type",
    shape = "Attendance Type"
  ) +
  theme_minimal()
```

## Conclusion 

The dataset contains information about students' academic performance and other factors that may influence their grades. We explored the distribution of grades and identified correlations between admission grades and first-year grades. We also examined the relationship between admission grades and previous qualification grades. Our analysis revealed that admission grades are positively correlated with first-year grades, indicating that students with higher admission grades tend to perform better in their first year. We also found a nonlinear relationship between admission grades and first-year grades, suggesting that the relationship is not strictly linear. Further analysis is needed to explore other factors that may influence academic performance

Also we found that correlation with sex is scholarship holder is not significant. But we can see that correlation with attendance type is significant. We can see that students with daytime attendance have higher grades than students with evening attendance. This may be due to the fact that daytime students have more time to study and attend classes, while evening students may have other commitments that prevent them from devoting as much time to their studies. This finding suggests that attendance type is an important factor to consider when analyzing academic performance.
